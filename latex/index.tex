\section*{Templates}

$\ast$$\ast$\+\_\+\+In the different mentionned files, be careful to change the paths.\+\_\+$\ast$$\ast$

{\bfseries An example is given at each step for 2015 data. It will be wrapped within a block quote as follows\+:}

\begin{quote}
Here is the example. \end{quote}






Templates is a package designed in the R\+O\+O\+T Analysis framework allowing to\+:
\begin{DoxyItemize}
\item measure the in-\/situ scale factors
\item build the systematics model for the scale factors
\item generate toys
\end{DoxyItemize}

The different measurements are performed as jobs running on the Centre de Calcul de Lyon (C\+C\+I\+N2\+P3) via a command called \char`\"{}sub1.\+sh\char`\"{} (personal bash script containing the line commands). It can be easily changed or run in interactive mode (scale factors measurement takes about 2h).

\subsection*{Download and setup }

The Template package depends on the Plot\+Functions one, meaning that you have to download both packages in the same directory from \href{mailto:git@github.com}{\tt git@github.\+com}\+:cgoudet. A Root\+Core will have to be setup in this directory.

``` git clone \href{mailto:git@github.com}{\tt git@github.\+com}\+:cgoudet/\+Template.\+git git clone \href{mailto:git@github.com}{\tt git@github.\+com}\+:cgoudet/\+Plot\+Functions.\+git rc\+Setup -\/r //to check the latest version of Root\+Core available rc\+Setup Base,2.\+4.\+X rc find\+\_\+packages rc compile ```

Make sure that in Template/cmt/\+Makefile.\+Root\+Core the Plot\+Functions dependency is added in P\+A\+C\+K\+A\+G\+E\+\_\+\+D\+E\+P.

\subsection*{Measuring scale factors }

Scale factors are measured from a Ntuple. To generate a smaller Ntuple from Dx\+A\+O\+D, see the e\+Gamma\+Scale\+Factors package.

The \hyperlink{MeasureScale_8cxx}{Measure\+Scale.\+cxx} macro allows to perform the measurement. The \hyperlink{Functions__MeasureAlphaSigma_8py}{Functions\+\_\+\+Measure\+Alpha\+Sigma.\+py} script sets the configuration needed and the job is submitted to the C\+C\+I\+N2\+P3 through the \hyperlink{MeasureAlphaSigma_8py}{Measure\+Alpha\+Sigma.\+py} script.

To run the program, call\+: ``` Measure\+Scale --config\+File your\+Conf\+File --data\+File\+Name your\+Data\+File1 --data\+Tree\+Name your\+Data\+Tree\+Name1 --data\+File\+Name your\+Data\+File2 --data\+Tree\+Name your\+Data\+Tree\+Name2 --M\+C\+File\+Name your\+M\+C\+File1 --M\+C\+Tree\+Name your\+M\+C\+Tree\+Name1 --out\+File\+Name your\+Output\+File $<$other options$>$=\char`\"{}\char`\"{}$>$ ``` Different options are supported by Measure\+Scale and are displayed/described in \hyperlink{MeasureScale_8cxx}{Measure\+Scale.\+cxx}.

The configuration file is a boost file containing all the options needed for the measurement (number of bins, Z mass fit range...). The list of the options with their default values can be found in \hyperlink{namespaceFunctions__MeasureAlphaSigma}{Functions\+\_\+\+Measure\+Alpha\+Sigma} in Create\+Config.

The Template framework allows to automatically generate those configuration files depending on the type of measurement you need to perform (nominal, different systematics, geometries, number of bins...).

\subsubsection*{Configuring your measurement}


\begin{DoxyItemize}
\item In \hyperlink{Functions__MeasureAlphaSigma_8py}{python/\+Functions\+\_\+\+Measure\+Alpha\+Sigma.\+py}, the F\+I\+L\+E\+S\+E\+T\+S map collects the keys corresponding to the Ntuple files you want to use to perform your measurement.
\end{DoxyItemize}

\begin{quote}
F\+I\+L\+E\+S\+E\+T\+S\mbox{[}'Data15\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1'\mbox{]} = \mbox{[} P\+R\+E\+F\+I\+X\+D\+A\+T\+A\+S\+E\+T\+S + 'Data15\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1/'\mbox{]} F\+I\+L\+E\+S\+E\+T\+S\mbox{[}'M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1'\mbox{]} = \mbox{[} P\+R\+E\+F\+I\+X\+D\+A\+T\+A\+S\+E\+T\+S + 'M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1/'\mbox{]} \end{quote}



\begin{DoxyItemize}
\item In \hyperlink{MeasureAlphaSigma_8py}{python/\+Measure\+Alpha\+Sigma.\+py}, each \char`\"{}line\char`\"{} (i.\+e. entry of the config\+Files list) corresponds to one job.
\end{DoxyItemize}

``` \mbox{[}'output\+File\+Name', 'data\+Key', 'M\+C\+Key', \mbox{[}options\+List\mbox{]}, mode\mbox{]} ```

\begin{quote}
\mbox{[}'Data\+Off\+\_\+13\+Te\+V\+\_\+15.\+root', 'Data15\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1', 'M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1',\mbox{[}\mbox{]}\mbox{]} \mbox{[}'Data\+Off\+\_\+13\+Te\+V\+\_\+\+Window.\+root', 'Data1615\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1', 'M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1', \mbox{[}'Z\+Mass\+Min=82.\+5', 'Z\+Mass\+Max=97.\+5'\mbox{]} \mbox{]} The 1st line corresponds to the nominal measurement, the second line to the measurement reducing the Z mass fit range for the window systematic. \end{quote}


More information on the different modes can be found in \hyperlink{namespaceFunctions__MeasureAlphaSigma}{Functions\+\_\+\+Measure\+Alpha\+Sigma} in Create\+Launcher def. The default mode is 3, which is the one to be used for the scale factors measurement.

\subsubsection*{Submitting the job}

For that you just need to run\+: ``` python \hyperlink{MeasureAlphaSigma_8py}{Measure\+Alpha\+Sigma.\+py} ```

If you don't want to submit your job to the C\+C\+I\+N2\+P3 you can comment the last block of commands in \hyperlink{MeasureAlphaSigma_8py}{Measure\+Alpha\+Sigma.\+py} (from sps\+Path to the end). Instead, just run the program in interactive mode.

\begin{quote}
Measure\+Scale --config\+File Data\+Off\+\_\+13\+Te\+V\+\_\+15.\+boost --data\+File\+Name Data15\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0.\+root --data\+File\+Name Data15\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+1.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+1\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+2.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+2\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+3.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+3\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+4.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+4\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+5.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+5\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+6.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+6\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+7.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+7\+\_\+corrected.\+root --out\+File\+Name Data\+Off\+\_\+13\+Te\+V\+\_\+15.\+root Measure\+Scale --config\+File Data\+Off\+\_\+13\+Te\+V\+\_\+15\+\_\+c.\+boost --data\+File\+Name Data15\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0.\+root --data\+File\+Name Data15\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+0\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+1.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+1\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+2.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+2\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+3.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+3\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+4.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+4\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+5.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+5\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+6.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+6\+\_\+corrected.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+7.\+root --M\+C\+File\+Name M\+C15c\+\_\+13\+Te\+V\+\_\+\+Zee\+\_\+\+Lkh1\+\_\+7\+\_\+corrected.\+root --out\+File\+Name Data\+Off\+\_\+13\+Te\+V\+\_\+15\+\_\+c.\+root --correct\+Alpha\+Hist\+Name meas\+Scale\+\_\+alpha --correct\+Alpha\+File\+Name Data\+Off\+\_\+13\+Te\+V\+\_\+15.\+root \end{quote}
